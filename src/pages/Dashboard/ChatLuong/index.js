import { ScatterPlot } from '@mui/x-charts/ScatterChart';
import { ResponsiveChartContainer, ChartsGrid, ChartsXAxis, ChartsYAxis, ChartsTooltip, ChartsLegend } from '@mui/x-charts';
import { useState, useEffect } from 'react';
import { fetchThongKeChatLuongAction } from '../../../redux/action/fetchDataAction/fetchThongKeChatLuongAction';
import { useDispatch, useSelector } from "react-redux";

const data = [
    { id: 'data-0', x1: 33, x2: 19.2, year: '2024' },
    { id: 'data-1', x1: 14, x2: 6.5, year: '2024' },
    { id: 'data-2', x1: 46, x2: 34.7, year: '2024' },
    { id: 'data-3', x1: 5, x2: 2.3, year: '2024' },
    { id: 'data-4', x1: 12, x2: 8.9, year: '2024' },
    { id: 'data-5', x1: 21, x2: 17.1, year: '2024' },
    { id: 'data-6', x1: 28, x2: 23.6, year: '2024' },
    { id: 'data-7', x1: 21, x2: 37.4, year: '2024' },
    { id: 'data-8', x1: 20, x2: 12.3, year: '2024' },
    { id: 'data-9', x1: 7, x2: 33.6, year: '2024' },
    { id: 'data-10', x1: 49, x2: 43.2, year: '2024' },
    { id: 'data-11', x1: 37, x2: 26.8, year: '2024' },
    { id: 'data-12', x1: 16, x2: 31.1, year: '2024' },
    { id: 'data-13', x1: 29, x2: 12.5, year: '2024' },
    { id: 'data-14', x1: 3, x2: 12.2, year: '2024' },
    { id: 'data-15', x1: 32, x2: 14.4, year: '2024' },
    { id: 'data-16', x1: 38, x2: 38.6, year: '2024' },
    { id: 'data-17', x1: 10, x2: 5.7, year: '2024' },
    { id: 'data-18', x1: 11, x2: 17.8, year: '2024' },
    { id: 'data-19', x1: 48, x2: 42.1, year: '2024' },
    { id: 'data-20', x1: 25, x2: 15.7, year: '2024' },
    { id: 'data-21', x1: 22, x2: 17.8, year: '2024' },
    { id: 'data-22', x1: 34, x2: 21.9, year: '2024' },
    { id: 'data-23', x1: 23, x2: 16.2, year: '2024' },
    { id: 'data-24', x1: 17, x2: 10.4, year: '2024' },
    { id: 'data-25', x1: 19, x2: 13.5, year: '2024' },
    { id: 'data-26', x1: 34, x2: 2.2, year: '2024' },
    { id: 'data-27', x1: 23, x2: 12.4, year: '2024' },
    { id: 'data-28', x1: 38, x2: 7.6, year: '2024' },
    { id: 'data-29', x1: 15, x2: 16.5, year: '2024' },
    { id: 'data-30', x1: 1, x2: 19.8, year: '2024' },
    { id: 'data-31', x1: 26, x2: 8.9, year: '2024' },
    { id: 'data-32', x1: 41, x2: 3.7, year: '2024' },
    { id: 'data-33', x1: 10, x2: 13.2, year: '2024' },
    { id: 'data-34', x1: 35, x2: 6.7, year: '2024' },
    { id: 'data-35', x1: 2, x2: 17.6, year: '2024' },
    { id: 'data-36', x1: 27, x2: 9.3, year: '2024' },
    { id: 'data-37', x1: 42, x2: 4.6, year: '2024' },
    { id: 'data-38', x1: 21, x2: 11.4, year: '2024' },
    { id: 'data-39', x1: 37, x2: 5.5, year: '2024' },
    { id: 'data-40', x1: 12, x2: 16.1, year: '2024' },
    { id: 'data-41', x1: 3, x2: 14.8, year: '2024' },
    { id: 'data-42', x1: 28, x2: 7.4, year: '2024' },
    { id: 'data-43', x1: 43, x2: 3.3, year: '2024' },
    { id: 'data-44', x1: 9, x2: 12.9, year: '2024' },
    { id: 'data-45', x1: 22, x2: 6.6, year: '2024' },
    { id: 'data-46', x1: 38, x2: 8.1, year: '2024' },
    { id: 'data-47', x1: 17, x2: 13.7, year: '2024' },
    { id: 'data-48', x1: 32, x2: 10.5, year: '2024' },
    { id: 'data-49', x1: 7, x2: 18.2, year: '2024' },
    { id: 'data-50', x1: 29, x2: 3.4, year: '2024' },
    { id: 'data-51', x1: 35, x2: 5.8, year: '2024' },
    { id: 'data-52', x1: 13, x2: 10.2, year: '2024' },
    { id: 'data-53', x1: 22, x2: 7.3, year: '2024' },
    { id: 'data-54', x1: 31, x2: 4.8, year: '2024' },
    { id: 'data-55', x1: 17, x2: 6.1, year: '2024' },
    { id: 'data-56', x1: 28, x2: 12.5, year: '2024' },
    { id: 'data-57', x1: 40, x2: 2.4, year: '2024' },
    { id: 'data-58', x1: 39, x2: 8.7, year: '2024' },
    { id: 'data-59', x1: 25, x2: 9.9, year: '2024' },
    { id: 'data-60', x1: 14, x2: 4.3, year: '2024' },
    { id: 'data-61', x1: 33, x2: 11.7, year: '2024' },
    { id: 'data-62', x1: 21, x2: 15.2, year: '2024' },
    { id: 'data-63', x1: 45, x2: 6.8, year: '2024' },
    { id: 'data-64', x1: 37, x2: 13.6, year: '2024' },
    { id: 'data-65', x1: 28, x2: 8.4, year: '2024' },
    { id: 'data-66', x1: 19, x2: 3.2, year: '2024' },
    { id: 'data-67', x1: 34, x2: 16.7, year: '2024' },
    { id: 'data-68', x1: 29, x2: 11.9, year: '2024' },
    { id: 'data-69', x1: 31, x2: 7.5, year: '2024' },
    { id: 'data-70', x1: 18, x2: 5.9, year: '2024' },
    { id: 'data-71', x1: 7, x2: 14.3, year: '2024' },
    { id: 'data-72', x1: 27, x2: 9.6, year: '2024' },
    { id: 'data-73', x1: 3, x2: 4.1, year: '2024' },
    { id: 'data-74', x1: 12, x2: 18.7, year: '2024' },
    { id: 'data-75', x1: 21, x2: 10.8, year: '2024' },
    { id: 'data-76', x1: 33, x2: 2.2, year: '2024' },
    { id: 'data-77', x1: 12, x2: 12.4, year: '2024' },
    { id: 'data-78', x1: 27, x2: 7.6, year: '2024' },
    { id: 'data-79', x1: 46, x2: 16.5, year: '2024' },
    { id: 'data-80', x1: 21, x2: 19.8, year: '2024' },
    { id: 'data-81', x1: 10, x2: 8.9, year: '2024' },
    { id: 'data-82', x1: 24, x2: 3.7, year: '2024' },
    { id: 'data-83', x1: 6, x2: 13.2, year: '2024' },
    { id: 'data-84', x1: 9, x2: 6.7, year: '2024' },
    { id: 'data-85', x1: 6, x2: 17.6, year: '2024' },
    { id: 'data-86', x1: 32, x2: 9.3, year: '2024' },
    { id: 'data-87', x1: 21, x2: 4.6, year: '2024' },
    { id: 'data-88', x1: 18, x2: 11.4, year: '2024' },
    { id: 'data-89', x1: 26, x2: 5.5, year: '2024' },
    { id: 'data-90', x1: 24, x2: 16.1, year: '2024' },
    { id: 'data-91', x1: 34, x2: 14.8, year: '2024' },
    { id: 'data-92', x1: 25, x2: 7.4, year: '2024' },
    { id: 'data-93', x1: 12, x2: 3.3, year: '2024' },
    { id: 'data-94', x1: 20, x2: 12.9, year: '2024' },
    { id: 'data-95', x1: 45, x2: 6.6, year: '2024' },
    { id: 'data-96', x1: 16, x2: 8.1, year: '2024' },
    { id: 'data-97', x1: 39, x2: 13.7, year: '2024' },
    { id: 'data-98', x1: 50, x2: 10.5, year: '2024' },
    { id: 'data-99', x1: 38, x2: 18.2, year: '2024' },

    { id: 'data-101', x1: 28, x2: 40.6, year: '2023' },
    { id: 'data-102', x1: 43, x2: 28.4, year: '2023' },
    { id: 'data-103', x1: 27, x2: 8.5, year: '2023' },
    { id: 'data-104', x1: 10, x2: 49.3, year: '2023' },
    { id: 'data-105', x1: 45, x2: 15.2, year: '2023' },
    { id: 'data-106', x1: 20, x2: 34.8, year: '2023' },
    { id: 'data-107', x1: 14, x2: 42.7, year: '2023' },
    { id: 'data-108', x1: 41, x2: 22.6, year: '2023' },
    { id: 'data-109', x1: 19, x2: 19.1, year: '2023' },
    { id: 'data-110', x1: 37, x2: 32.9, year: '2023' },
    { id: 'data-111', x1: 38, x2: 46.3, year: '2023' },
    { id: 'data-112', x1: 18, x2: 39.4, year: '2023' },
    { id: 'data-113', x1: 13, x2: 28.8, year: '2023' },
    { id: 'data-114', x1: 46, x2: 24.9, year: '2023' },
    { id: 'data-115', x1: 7, x2: 37.7, year: '2023' },
    { id: 'data-116', x1: 26, x2: 44.2, year: '2023' },
    { id: 'data-117', x1: 6, x2: 12.1, year: '2023' },
    { id: 'data-118', x1: 33, x2: 31.4, year: '2023' },
    { id: 'data-119', x1: 32, x2: 48.9, year: '2023' },
    { id: 'data-120', x1: 22, x2: 19.8, year: '2023' },
    { id: 'data-121', x1: 14, x2: 6.6, year: '2023' },
    { id: 'data-122', x1: 9, x2: 29.7, year: '2023' },
    { id: 'data-123', x1: 38, x2: 9.4, year: '2023' },
    { id: 'data-124', x1: 45, x2: 21.7, year: '2023' },
    { id: 'data-125', x1: 39, x2: 38.9, year: '2023' },
    { id: 'data-126', x1: 16, x2: 35.1, year: '2023' },
    { id: 'data-127', x1: 33, x2: 45.7, year: '2023' },
    { id: 'data-128', x1: 26, x2: 31.8, year: '2023' },
    { id: 'data-129', x1: 30, x2: 45.7, year: '2023' },
    { id: 'data-130', x1: 11, x2: 48.7, year: '2023' },
    { id: 'data-131', x1: 32, x2: 10.6, year: '2023' },
    { id: 'data-132', x1: 7, x2: 15.8, year: '2023' },
    { id: 'data-133', x1: 23, x2: 16.2, year: '2023' },
    { id: 'data-134', x1: 27, x2: 26.3, year: '2023' },
    { id: 'data-135', x1: 42, x2: 20.4, year: '2023' },
    { id: 'data-136', x1: 36, x2: 46.9, year: '2023' },
    { id: 'data-137', x1: 16, x2: 39.5, year: '2023' },
    { id: 'data-138', x1: 17, x2: 45.5, year: '2023' },
    { id: 'data-139', x1: 22, x2: 30.2, year: '2023' },
    { id: 'data-140', x1: 47, x2: 48.8, year: '2023' },
    { id: 'data-141', x1: 15, x2: 44.5, year: '2023' },
    { id: 'data-142', x1: 36, x2: 11.4, year: '2023' },
    { id: 'data-143', x1: 34, x2: 26.7, year: '2023' },
    { id: 'data-144', x1: 27, x2: 39.4, year: '2023' },
    { id: 'data-145', x1: 15, x2: 32.5, year: '2023' },
    { id: 'data-146', x1: 35, x2: 9.2, year: '2023' },
    { id: 'data-147', x1: 36, x2: 17.6, year: '2023' },
    { id: 'data-148', x1: 3, x2: 22.3, year: '2023' },
    { id: 'data-149', x1: 16, x2: 13.5, year: '2023' },
    { id: 'data-84', x1: 22, x2: 17.9, year: '2023' },
    { id: 'data-85', x1: 44, x2: 33.5, year: '2023' },
    { id: 'data-86', x1: 15, x2: 26.2, year: '2023' },
    { id: 'data-87', x1: 6, x2: 21.7, year: '2023' },
    { id: 'data-88', x1: 34, x2: 5.3, year: '2023' },
    { id: 'data-89', x1: 40, x2: 20.8, year: '2023' },
    { id: 'data-90', x1: 12, x2: 40.4, year: '2023' },
    { id: 'data-91', x1: 9, x2: 3.9, year: '2023' },
    { id: 'data-92', x1: 31, x2: 42.3, year: '2023' },
    { id: 'data-93', x1: 48, x2: 48.6, year: '2023' },
    { id: 'data-94', x1: 37, x2: 6.1, year: '2023' },
    { id: 'data-95', x1: 49, x2: 31.2, year: '2023' },
    { id: 'data-96', x1: 40, x2: 17.5, year: '2023' },
    { id: 'data-97', x1: 24, x2: 26.4, year: '2023' },
    { id: 'data-98', x1: 11, x2: 47.1, year: '2023' },
    { id: 'data-99', x1: 20, x2: 11.9, year: '2023' },
    { id: 'data-100', x1: 19, x2: 13.7, year: '2023' },

    { id: 'data-0', x1: 29, x2: 38.9, year: '2022' },
    { id: 'data-1', x1: 2, x2: 25.4, year: '2022' },
    { id: 'data-2', x1: 13, x2: 20.8, year: '2022' },
    { id: 'data-3', x1: 23, x2: 9.6, year: '2022' },
    { id: 'data-4', x1: 39, x2: 31.3, year: '2022' },
    { id: 'data-5', x1: 22, x2: 3.7, year: '2022' },
    { id: 'data-6', x1: 28, x2: 1.3, year: '2022' },
    { id: 'data-7', x1: 38, x2: 20.1, year: '2022' },
    { id: 'data-8', x1: 35, x2: 26.7, year: '2022' },
    { id: 'data-9', x1: 15, x2: 7.2, year: '2022' },
    { id: 'data-10', x1: 49, x2: 15.4, year: '2022' },
    { id: 'data-11', x1: 8, x2: 41.6, year: '2022' },
    { id: 'data-12', x1: 35, x2: 17.7, year: '2022' },
    { id: 'data-13', x1: 6, x2: 5.2, year: '2022' },
    { id: 'data-14', x1: 33, x2: 24.3, year: '2022' },
    { id: 'data-15', x1: 28, x2: 8.9, year: '2022' },
    { id: 'data-16', x1: 43, x2: 38.9, year: '2022' },
    { id: 'data-17', x1: 16, x2: 35.1, year: '2022' },
    { id: 'data-18', x1: 33, x2: 45.7, year: '2022' },
    { id: 'data-19', x1: 26, x2: 31.8, year: '2022' },
    { id: 'data-20', x1: 30, x2: 45.7, year: '2022' },
    { id: 'data-21', x1: 11, x2: 48.7, year: '2022' },
    { id: 'data-22', x1: 32, x2: 10.6, year: '2022' },
    { id: 'data-23', x1: 7, x2: 15.8, year: '2022' },
    { id: 'data-24', x1: 23, x2: 16.2, year: '2022' },
    { id: 'data-25', x1: 27, x2: 26.3, year: '2022' },
    { id: 'data-26', x1: 42, x2: 20.4, year: '2022' },
    { id: 'data-27', x1: 36, x2: 46.9, year: '2022' },
    { id: 'data-28', x1: 16, x2: 39.5, year: '2022' },
    { id: 'data-29', x1: 17, x2: 45.5, year: '2022' },
    { id: 'data-30', x1: 22, x2: 30.2, year: '2022' },
    { id: 'data-31', x1: 47, x2: 48.8, year: '2022' },
    { id: 'data-32', x1: 15, x2: 44.5, year: '2022' },
    { id: 'data-33', x1: 36, x2: 11.4, year: '2022' },
    { id: 'data-34', x1: 34, x2: 26.7, year: '2022' },
    { id: 'data-35', x1: 27, x2: 39.4, year: '2022' },
    { id: 'data-36', x1: 15, x2: 32.5, year: '2022' },
    { id: 'data-37', x1: 35, x2: 9.2, year: '2022' },
    { id: 'data-38', x1: 36, x2: 17.6, year: '2022' },
    { id: 'data-39', x1: 3, x2: 22.3, year: '2022' },
    { id: 'data-40', x1: 16, x2: 13.5, year: '2022' },
    { id: 'data-41', x1: 25, x2: 39.9, year: '2022' },
    { id: 'data-42', x1: 36, x2: 5.8, year: '2022' },
    { id: 'data-43', x1: 39, x2: 6.7, year: '2022' },
    { id: 'data-44', x1: 26, x2: 21.7, year: '2022' },
    { id: 'data-45', x1: 19, x2: 26.4, year: '2022' },
    { id: 'data-46', x1: 21, x2: 3.9, year: '2022' },
    { id: 'data-47', x1: 29, x2: 27.4, year: '2022' },
    { id: 'data-48', x1: 39, x2: 34.6, year: '2022' },
    { id: 'data-49', x1: 3, x2: 7.7, year: '2022' },   
    { id: 'data-50', x1: 43, x2: 38.9, year: '2022' },
    { id: 'data-51', x1: 16, x2: 35.1, year: '2022' },
    { id: 'data-52', x1: 33, x2: 45.7, year: '2022' },
    { id: 'data-53', x1: 26, x2: 31.8, year: '2022' },
    { id: 'data-54', x1: 30, x2: 45.7, year: '2022' },
    { id: 'data-55', x1: 11, x2: 48.7, year: '2022' },
    { id: 'data-56', x1: 32, x2: 10.6, year: '2022' },
    { id: 'data-57', x1: 7, x2: 15.8, year: '2022' },
    { id: 'data-58', x1: 23, x2: 16.2, year: '2022' },
    { id: 'data-59', x1: 27, x2: 26.3, year: '2022' },
    { id: 'data-60', x1: 42, x2: 20.4, year: '2022' },
    { id: 'data-61', x1: 36, x2: 46.9, year: '2022' },
    { id: 'data-62', x1: 16, x2: 39.5, year: '2022' },
    { id: 'data-63', x1: 17, x2: 45.5, year: '2022' },
    { id: 'data-64', x1: 22, x2: 30.2, year: '2022' },
    { id: 'data-65', x1: 47, x2: 48.8, year: '2022' },
    { id: 'data-66', x1: 15, x2: 44.5, year: '2022' },
    { id: 'data-67', x1: 36, x2: 11.4, year: '2022' },
    { id: 'data-68', x1: 34, x2: 26.7, year: '2022' },
    { id: 'data-69', x1: 27, x2: 39.4, year: '2022' },
    { id: 'data-70', x1: 15, x2: 32.5, year: '2022' },
    { id: 'data-71', x1: 35, x2: 9.2, year: '2022' },
    { id: 'data-72', x1: 36, x2: 17.6, year: '2022' },
    { id: 'data-73', x1: 3, x2: 22.3, year: '2022' },
    { id: 'data-74', x1: 16, x2: 13.5, year: '2022' },
    { id: 'data-75', x1: 25, x2: 39.9, year: '2022' },
    { id: 'data-76', x1: 36, x2: 5.8, year: '2022' },
    { id: 'data-77', x1: 39, x2: 6.7, year: '2022' },
    { id: 'data-78', x1: 26, x2: 21.7, year: '2022' },
    { id: 'data-79', x1: 19, x2: 26.4, year: '2022' },
    { id: 'data-80', x1: 21, x2: 3.9, year: '2022' },
    { id: 'data-81', x1: 29, x2: 27.4, year: '2022' },
    { id: 'data-82', x1: 39, x2: 34.6, year: '2022' },
    { id: 'data-83', x1: 3, x2: 7.7, year: '2022' },
];


export default function ChatLuong({ year }) {
    const dispatch = useDispatch();
    const [filterData, setFilterData] = useState([])
    const data = useSelector((state) => state.tkChatLuong?.data) || [];
    console.log("data", data);

    useEffect(() => {
        dispatch(fetchThongKeChatLuongAction());
      }, []);

    useEffect(() => {
        if (year) {
            const yearData = data.filter(item => item.YEAR === year);
            setFilterData(yearData);
        }
    }, [year]);

    return (
        <div>
            <ResponsiveChartContainer
                xAxis={[{ label: 'Thời gian khám mới trung bình (tuần)', }]}
                yAxis={[{
                    id: 'yAxis',
                    label: 'Số lượt khám',
                    colorMap: {
                        type: 'continuous',
                        min: 10,
                        max: 30,
                        color: ['indigo', 'tomato']
                    }
                }]}
                height={400}
                margin={{ left: 90, right: 50 }}
                series={[
                    {
                        type: 'scatter',
                        label: "Khách hàng",
                        data: filterData.map((v) => ({ x: v.X2, y: v.X1, id: v.ID })),
                        markerSize: 5,
                        color: 'tomato'
                    },
                ]}
            >
                <ScatterPlot />
                <ChartsLegend position={{ vertical: 'top', horizontal: 'right' }} />
                <ChartsGrid horizontal vertical />
                <ChartsXAxis />
                <ChartsYAxis label='Số lượt khám' />
                <ChartsTooltip trigger='item' />
            </ResponsiveChartContainer>
        </div>
    );
}
